<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curricolo Verticale Servizi per la Sanità e l'Assistenza Sociale (SSAS)</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="app">
  <div class="header">
    <div class="hero">
      <div class="hero-copy">
        <div class="badge-row">
          <div class="update-badge">🆕 VERSIONE AGGIORNATA</div>
          <p class="subtitle">Allegato C del Regolamento del 24 maggio 2018, n. 92</p>
        </div>
        <h1 class="app-title">Curricolo Verticale Servizi per la Sanità e l'Assistenza Sociale (SSAS)</h1>
        <p class="scuola">ISTITUTO DI ISTRUZIONE SUPERIORE<br>"A. Meucci - E. Mattei" · Sede Decimomannu</p>
      </div>
      <div class="hero-shape">
        <p class="hero-shape-copy">Il tuo supporto agile per la progettazione didattica</p>
      </div>
    </div>

    <div class="top-controls" role="toolbar" aria-label="Comandi pagina">
      <div class="top-actions">
        <button type="button" class="action-btn ghost" onclick="document.getElementById('filtersBlock').scrollIntoView({behavior:'smooth'})">🎛️ Pannello Filtri</button>
        <button type="button" class="action-btn primary" onclick="exportCSV()">📤 Esporta risultati</button>
        <button class="theme-toggle" id="themeToggle" aria-label="Tema">🌙</button>
      </div>
    </div>

    <details class="guida" open>
      <summary>📘 Guida all’uso</summary>
      <div class="guida-body">
        <p>Consulta tutte le conoscenze suddivise per Biennio e Triennio del curricolo SSAS.</p>
        <p>Ogni competenza riporta le conoscenze correlate e gli insegnamenti che contribuiscono al suo sviluppo.</p>
        <p>Le abilità e le competenze intermedie sono disponibili nel documento completo per chi desidera approfondire.</p>
      </div>
    </details>

    <button class="filter-toggle" id="filterToggle" aria-expanded="true">🎯 Mostra/Nascondi Filtri</button>

    <div class="quick-info">
      <div>
        <h3>🎓 Focus didattico</h3>
        <p>Navighi le competenze con filtri rapidi e una tabella pivot dinamica. Ogni selezione aggiorna i risultati in tempo reale.</p>
      </div>
      <div>
        <h3>📱 Ottimizzato per mobile</h3>
        <p>Il layout risponde allo schermo: usa la barra mobile in basso per accedere rapidamente ai filtri, esportare o tornare all’inizio.</p>
      </div>
    </div>

    <div class="feedback" aria-live="assertive">
      <div class="success-message" id="successMessage"></div>
      <div class="error-message" id="errorMessage"></div>
    </div>

    <div class="controls collapsible" id="filtersBlock">
      <div class="control-group">
        <div class="control">
          <label for="competenzaFilter">🎯 Filtra per Competenza</label>
          <select id="competenzaFilter">
            <option value="">Tutte le Competenze</option>
          </select>
        </div>
        <div class="control">
          <label for="periodoFilter">📅 Filtra per Periodo</label>
          <select id="periodoFilter">
            <option value="">Tutti i Periodi</option>
          </select>
        </div>
        <div class="control">
          <label for="insegnamentoFilter">📚 Filtra per Insegnamento</label>
          <select id="insegnamentoFilter">
            <option value="">Tutti gli Insegnamenti</option>
          </select>
        </div>
      </div>
      <div class="pivot-controls">
        <div class="control">
          <label for="rowGroup">Raggruppa per Righe</label>
          <select id="rowGroup">
            <option value="competenza">Competenza</option>
            <option value="periodo">Periodo</option>
            <option value="insegnamento">Insegnamento</option>
          </select>
        </div>
        <div class="control">
          <label for="colGroup">Raggruppa per Colonne</label>
          <select id="colGroup">
            <option value="periodo">Periodo</option>
            <option value="competenza">Competenza</option>
            <option value="insegnamento">Insegnamento</option>
          </select>
        </div>
        <div class="control">
          <label for="valueType">Mostra Valori</label>
          <select id="valueType">
            <option value="count">Numero Conoscenze</option>
            <option value="list">Lista Conoscenze</option>
          </select>
        </div>
      </div>
      <button class="reset-btn" onclick="resetFilters()">🔄 Reset Filtri</button>
    </div>

    <div class="stats" id="stats"></div>
    <div class="pivot-scroll">
      <div class="pivot-table" id="pivotTable"></div>
    </div>
    <div class="detail-table" id="detailTable"></div>
  </div>
</div>

<div class="mobile-bar" role="navigation" aria-label="Azioni rapide">
  <button onclick="resetFilters()" title="Reset filtri">🔄</button>
  <button onclick="document.getElementById('filterToggle').click()" title="Apri filtri">🎛️</button>
  <button onclick="exportCSV()" title="Esporta CSV">📄</button>
  <button onclick="window.scrollTo({top:0,behavior:'smooth'})" title="Torna su">⬆️</button>
</div>

<script src="script.js"></script>
<script>
  document.getElementById('filterToggle').addEventListener('click', () => {
    const blk = document.getElementById('filtersBlock');
    blk.classList.toggle('closed');
    const expanded = !blk.classList.contains('closed');
    document.getElementById('filterToggle').setAttribute('aria-expanded', expanded);
  });
</script>
</body>
</html>
