<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Curricolo Verticale Servizi per la Sanit√† e l'Assistenza Sociale (SSAS) - Gestione competenze e conoscenze">
    <meta name="keywords" content="SSAS, curricolo, competenze, sanit√†, assistenza sociale">
    <title>Curricolo Verticale SSAS - Gestione Competenze</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="app.js" as="script">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè•</text></svg>">
</head>
<body>
    <!-- Loading spinner -->
    <div id="loadingSpinner" class="loading-spinner"></div>
    
    <div class="container">
        <!-- Header ottimizzato -->
        <header class="header">
            <h1>Curricolo Verticale Servizi per la Sanit√† e l'Assistenza Sociale (SSAS)</h1>
            <div class="update-badge" role="status" aria-label="Versione aggiornata">
                üÜï VERSIONE AGGIORNATA
            </div>
            <p>Allegato C del Regolamento del 24 maggio 2018, n. 92</p>
            
            <!-- Mode toggle -->
            <div class="mode-toggle" role="radiogroup" aria-label="Modalit√† applicazione">
                <button class="mode-btn active" 
                        onclick="app.setMode('view')" 
                        role="radio" 
                        aria-checked="true"
                        aria-label="Modalit√† visualizzazione">
                    üëÅÔ∏è Visualizza
                </button>
                <button class="mode-btn" 
                        onclick="app.setMode('edit')" 
                        role="radio" 
                        aria-checked="false"
                        aria-label="Modalit√† modifica">
                    ‚úèÔ∏è Modifica
                </button>
            </div>
        </header>
        
        <!-- Edit controls -->
        <section class="edit-controls" aria-labelledby="edit-controls-title">
            <h3 id="edit-controls-title">üîß Modalit√† Modifica Attiva</h3>
            <div class="edit-actions">
                <button class="edit-btn" onclick="app.showAddForm()" aria-label="Aggiungi nuova conoscenza">
                    ‚ûï Aggiungi Conoscenza
                </button>
                <button class="edit-btn" onclick="app.saveData()" aria-label="Salva tutte le modifiche">
                    üíæ Salva Modifiche
                </button>
                <button class="edit-btn" onclick="app.exportData('csv')" aria-label="Esporta dati in formato CSV">
                    üì§ Esporta CSV
                </button>
                <button class="edit-btn" onclick="app.exportData('excel')" aria-label="Esporta dati in formato Excel">
                    üìä Esporta Excel
                </button>
                <button class="edit-btn danger" onclick="app.deleteSelectedRows()" aria-label="Elimina righe selezionate">
                    üóëÔ∏è Elimina Selezionati
                </button>
            </div>
        </section>
        
        <!-- Messages container -->
        <div id="messagesContainer" aria-live="polite">
            <div class="message success-message" id="successMessage"></div>
            <div class="message error-message" id="errorMessage"></div>
            <div class="message info-message" id="infoMessage"></div>
        </div>
        
        <!-- Advanced search -->
        <section class="search-section" aria-labelledby="search-title">
            <h2 id="search-title" class="sr-only">Ricerca avanzata</h2>
            <div class="search-box">
                <input type="text" 
                       id="searchInput" 
                       class="search-input" 
                       placeholder="Cerca in tutte le competenze e conoscenze..." 
                       aria-label="Campo di ricerca globale"
                       aria-describedby="search-help">
                <span class="search-icon" aria-hidden="true">üîç</span>
                <div id="search-help" class="sr-only">
                    Digita per cercare in tempo reale. Usa Ctrl+F per accedere rapidamente.
                </div>
            </div>
        </section>
        
        <!-- Statistics cards -->
        <section class="stats" aria-labelledby="stats-title">
            <h2 id="stats-title" class="sr-only">Statistiche del curricolo</h2>
            
            <div class="stat-card" role="img" aria-labelledby="stat-competenze">
                <div class="stat-number" id="stat-competenze" aria-label="Numero competenze">0</div>
                <div class="stat-label">Competenze</div>
            </div>
            
            <div class="stat-card" role="img" aria-labelledby="stat-conoscenze">
                <div class="stat-number" id="stat-conoscenze" aria-label="Numero conoscenze">0</div>
                <div class="stat-label">Conoscenze</div>
            </div>
            
            <div class="stat-card" role="img" aria-labelledby="stat-periodi">
                <div class="stat-number" id="stat-periodi" aria-label="Numero periodi">0</div>
                <div class="stat-label">Periodi</div>
            </div>
            
            <div class="stat-card" role="img" aria-labelledby="stat-insegnamenti">
                <div class="stat-number" id="stat-insegnamenti" aria-label="Numero insegnamenti">0</div>
                <div class="stat-label">Insegnamenti</div>
            </div>
        </section>
        
        <!-- Filters -->
        <section class="controls" aria-labelledby="filters-title">
            <h2 id="filters-title">Filtri di Ricerca</h2>
            
            <div class="control-group">
                <div class="control">
                    <label for="competenzaFilter">üéØ Filtra per Competenza</label>
                    <select id="competenzaFilter" aria-describedby="competenza-help">
                        <option value="">Tutte le Competenze</option>
                    </select>
                    <div id="competenza-help" class="sr-only">Seleziona una competenza specifica per filtrare i risultati</div>
                </div>
                
                <div class="control">
                    <label for="periodoFilter">üìÖ Filtra per Periodo</label>
                    <select id="periodoFilter" aria-describedby="periodo-help">
                        <option value="">Tutti i Periodi</option>
                    </select>
                    <div id="periodo-help" class="sr-only">Seleziona un periodo specifico per filtrare i risultati</div>
                </div>
                
                <div class="control">
                    <label for="insegnamentoFilter">üìö Filtra per Insegnamento</label>
                    <select id="insegnamentoFilter" aria-describedby="insegnamento-help">
                        <option value="">Tutti gli Insegnamenti</option>
                    </select>
                    <div id="insegnamento-help" class="sr-only">Seleziona un insegnamento specifico per filtrare i risultati</div>
                </div>
                
                <div class="control">
                    <button class="btn btn-secondary" onclick="app.resetFilters()" aria-label="Resetta tutti i filtri">
                        üîÑ Reset Filtri
                    </button>
                    <div class="keyboard-hint">Scorciatoia: Ctrl+R</div>
                </div>
            </div>
        </section>
        
        <!-- Pivot table controls -->
        <section class="pivot-controls" aria-labelledby="pivot-title">
            <h2 id="pivot-title" class="sr-only">Controlli tabella pivot</h2>
            
            <div class="control">
                <label for="rowGroup">Raggruppa per Righe</label>
                <select id="rowGroup" aria-describedby="row-help">
                    <option value="competenza">Competenza</option>
                    <option value="periodo">Periodo</option>
                    <option value="insegnamento">Insegnamento</option>
                </select>
                <div id="row-help" class="sr-only">Seleziona il criterio di raggruppamento per le righe</div>
            </div>
            
            <div class="control">
                <label for="colGroup">Raggruppa per Colonne</label>
                <select id="colGroup" aria-describedby="col-help">
                    <option value="periodo">Periodo</option>
                    <option value="competenza">Competenza</option>
                    <option value="insegnamento">Insegnamento</option>
                </select>
                <div id="col-help" class="sr-only">Seleziona il criterio di raggruppamento per le colonne</div>
            </div>
            
            <div class="control">
                <label for="valueType">Tipo di Valore</label>
                <select id="valueType" aria-describedby="value-help">
                    <option value="count">Conteggio</option>
                    <option value="percentage">Percentuale</option>
                </select>
                <div id="value-help" class="sr-only">Seleziona il tipo di valore da visualizzare nelle celle</div>
            </div>
        </section>
        
        <!-- Pivot table -->
        <section aria-labelledby="pivot-table-title">
            <h2 id="pivot-table-title">Tabella Pivot Interattiva</h2>
            <div id="pivotTable" class="pivot-table-container" role="region" aria-label="Tabella pivot delle competenze">
                <!-- La tabella pivot verr√† generata dinamicamente -->
            </div>
        </section>
        
        <!-- Detail table -->
        <section aria-labelledby="detail-table-title">
            <h2 id="detail-table-title">Tabella Dettagliata</h2>
            <div id="detailTable" class="detail-table-container" role="region" aria-label="Tabella dettagliata delle conoscenze">
                <!-- La tabella dei dettagli verr√† generata dinamicamente -->
            </div>
        </section>
    </div>
    
    <!-- Keyboard shortcuts help -->
    <div id="keyboardHelp" class="keyboard-help-panel" aria-labelledby="keyboard-help-title">
        <h3 id="keyboard-help-title">Scorciatoie da Tastiera</h3>
        <ul>
            <li><kbd>Ctrl</kbd> + <kbd>F</kbd> - Attiva ricerca</li>
            <li><kbd>Ctrl</kbd> + <kbd>R</kbd> - Reset filtri</li>
            <li><kbd>Ctrl</kbd> + <kbd>S</kbd> - Salva (modalit√† modifica)</li>
            <li><kbd>Esc</kbd> - Chiudi modal</li>
        </ul>
    </div>
    
    <!-- Scripts -->
    <script src="app.js"></script>
    
    <!-- Service Worker per prestazioni migliori -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>