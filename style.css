*,*::before,*::after{box-sizing:border-box;}
:root{
  color-scheme:light;
  --bg:linear-gradient(160deg,#eef2ff 0%,#f8fbff 40%,#ffffff 100%);
  --surface:#ffffff;
  --surface-soft:#f4f6ff;
  --surface-muted:#eef2fb;
  --surface-strong:#d9e1ff;
  --outline:#d5dcf0;
  --divider:#e5e9f5;
  --text:#1f2633;
  --text-soft:#4d5a70;
  --text-muted:#6f7c96;
  --accent:#4a63ff;
  --accent-strong:#3645ff;
  --accent-soft:rgba(74,99,255,.12);
  --accent-grad:linear-gradient(135deg,#5165ff 0%,#7a5bff 100%);
  --success:#2d7a58;
  --success-soft:#e6f6ee;
  --danger:#b81f31;
  --danger-soft:#fdecef;
  --radius-lg:28px;
  --radius-md:18px;
  --radius-sm:12px;
  --shadow-sm:0 8px 24px -12px rgba(24,37,71,.25);
  --shadow-md:0 26px 60px -32px rgba(45,55,105,.35);
  --shadow-lg:0 40px 80px -40px rgba(53,63,115,.45);
  --transition:.25s ease;
  --font-sans:"Inter","Segoe UI",Roboto,system-ui,-apple-system,sans-serif;
}
:root[data-theme='dark']{
  color-scheme:dark;
  --bg:linear-gradient(160deg,#070b1b 0%,#111b35 45%,#1a2141 100%);
  --surface:#151b31;
  --surface-soft:#1c2442;
  --surface-muted:#202b4a;
  --surface-strong:#28345a;
  --outline:#273151;
  --divider:#2f3b61;
  --text:#f5f7ff;
  --text-soft:#c7cee6;
  --text-muted:#8d97bb;
  --accent:#8ea6ff;
  --accent-strong:#a0b4ff;
  --accent-soft:rgba(142,166,255,.18);
  --success:#69d9a6;
  --success-soft:rgba(62,162,113,.16);
  --danger:#ff6f82;
  --danger-soft:rgba(255,111,130,.18);
  --shadow-sm:0 12px 30px -16px rgba(2,10,40,.6);
  --shadow-md:0 30px 70px -34px rgba(0,6,32,.55);
  --shadow-lg:0 45px 110px -46px rgba(0,8,42,.62);
}
:root[data-theme='dark'] body{background:var(--bg);}
body{
  font-family:var(--font-sans);
  margin:0;
  min-height:100vh;
  color:var(--text);
  background:var(--bg);
  display:flex;
  justify-content:center;
}
body,button,select,input{font-size:16px;}
button,input,select{font-family:inherit;}
button{border:none;background:none;cursor:pointer;transition:var(--transition);}
button:disabled{cursor:not-allowed;opacity:.6;}
:focus-visible{outline:3px solid rgba(74,99,255,.35);outline-offset:2px;}

.app{width:100%;}
.header{
  width:min(1080px,100%);
  margin:0 auto;
  padding:clamp(20px,4vw,48px) clamp(16px,5vw,54px) 72px;
  display:flex;
  flex-direction:column;
  gap:clamp(18px,4vw,30px);
  align-items:stretch;
  box-sizing:border-box;
}

.hero{
  background:var(--surface);
  border-radius:var(--radius-lg);
  padding:clamp(20px,5vw,36px);
  display:flex;
  flex-wrap:wrap;
  gap:28px;
  position:relative;
  overflow:hidden;
  align-items:center;
  box-shadow:var(--shadow-lg);
}
.hero::after{
  content:"";
  position:absolute;
  inset:12% auto auto 58%;
  width:260px;
  height:260px;
  background:radial-gradient(circle at center,rgba(74,99,255,.24) 0%,rgba(74,99,255,0) 70%);
  filter:blur(0.4px);
  transform:translateY(-16%);
  pointer-events:none;
}
.hero-copy{
  flex:1 1 280px;
  display:flex;
  flex-direction:column;
  gap:clamp(10px,2vw,18px);
  position:relative;
  z-index:2;
}
.hero-shape{
  flex:1 1 220px;
  min-height:200px;
  border-radius:36px;
  background:radial-gradient(circle at 20% 20%,rgba(138,148,255,.45),transparent 65%),
             linear-gradient(160deg,rgba(74,99,255,.24) 0%,rgba(146,104,255,.32) 60%,transparent 100%);
  filter:saturate(115%);
  box-shadow:0 30px 80px -40px rgba(74,99,255,.48);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:clamp(18px,4vw,26px);
}
.hero-shape-copy{
  margin:0;
  color:rgba(255,255,255,.92);
  font-size:clamp(1.05rem,2.7vw,1.35rem);
  font-weight:600;
  letter-spacing:.02em;
  line-height:1.4;
  max-width:18ch;
}
.badge-row{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  align-items:center;
  color:var(--text-muted);
}
.app-title{
  margin:0;
  font-size:clamp(1.8rem,4vw,2.7rem);
  line-height:1.08;
  color:var(--text);
  letter-spacing:-.01em;
}
.subtitle{
  margin:0;
  font-size:.95rem;
  color:var(--text-muted);
  letter-spacing:.4px;
}
.scuola{
  margin:0;
  font-weight:600;
  font-size:1rem;
  color:var(--text-soft);
  line-height:1.4;
}
.update-badge{
  background:var(--accent-grad);
  color:#fff;
  padding:.45rem .9rem;
  border-radius:999px;
  font-size:.75rem;
  letter-spacing:.6px;
  box-shadow:0 12px 30px -18px rgba(74,99,255,.7);
  font-weight:600;
}

.top-controls{
  display:flex;
  flex-wrap:wrap;
  gap:14px;
  align-items:center;
  justify-content:flex-end;
}
.top-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}
.action-btn{
  padding:.6rem 1rem;
  border-radius:var(--radius-sm);
  font-weight:600;
  letter-spacing:.02em;
  border:1px solid transparent;
}
.action-btn.primary{
  background:var(--accent-grad);
  color:#fff;
  box-shadow:0 16px 36px -20px rgba(74,99,255,.6);
}
.action-btn.primary:hover{transform:translateY(-1px);box-shadow:0 20px 40px -22px rgba(74,99,255,.65);}
.action-btn.ghost{
  background:var(--surface);
  border:1px solid var(--outline);
  color:var(--text);
}
.action-btn.ghost:hover{border-color:var(--accent);color:var(--accent);}
.theme-toggle{
  background:var(--surface);
  border:1px solid var(--outline);
  border-radius:var(--radius-sm);
  padding:.6rem .75rem;
  font-size:1.05rem;
  line-height:1;
  box-shadow:var(--shadow-sm);
  color:var(--text);
}
.theme-toggle:hover{border-color:var(--accent);color:var(--accent);}

.guida{
  background:var(--surface);
  border-radius:var(--radius-md);
  box-shadow:var(--shadow-sm);
  padding:0;
  overflow:hidden;
  border:1px solid var(--outline);
}
.guida[open] summary{border-bottom:1px solid var(--divider);}
.guida summary{
  cursor:pointer;
  padding:1rem 1.4rem;
  font-weight:600;
  color:var(--text);
  list-style:none;
  position:relative;
}
.guida summary::-webkit-details-marker{display:none;}
.guida-body{
  padding:1.1rem 1.4rem 1.3rem;
  display:flex;
  flex-direction:column;
  gap:.65rem;
  color:var(--text-soft);
  font-size:.95rem;
}

.filter-toggle{
  align-self:flex-start;
  padding:.65rem 1.15rem;
  border-radius:999px;
  background:var(--surface);
  border:1px solid var(--outline);
  font-weight:600;
  color:var(--text);
  box-shadow:var(--shadow-sm);
}
.filter-toggle:hover{border-color:var(--accent);color:var(--accent);}

.quick-info{
  display:grid;
  gap:18px;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
}
.quick-info h3{
  margin:.2rem 0;
  font-size:1.05rem;
  color:var(--text);
}
.quick-info p{
  margin:0;
  font-size:.9rem;
  color:var(--text-soft);
  line-height:1.5;
}
.quick-info > div{
  background:var(--surface);
  border-radius:var(--radius-md);
  padding:1.2rem 1.4rem;
  border:1px solid var(--outline);
  box-shadow:var(--shadow-sm);
}


.feedback{
  display:flex;
  flex-direction:column;
  gap:.6rem;
  min-height:1.5rem;
}
.success-message,.error-message{
  display:none;
  padding:.75rem 1rem;
  border-radius:var(--radius-sm);
  font-size:.88rem;
  font-weight:600;
}
.success-message{background:var(--success-soft);color:var(--success);border:1px solid rgba(45,122,88,.25);}
.error-message{background:var(--danger-soft);color:var(--danger);border:1px solid rgba(184,31,49,.22);}

.controls{
  background:var(--surface);
  border-radius:var(--radius-lg);
  border:1px solid var(--outline);
  padding:1.5rem clamp(1rem,4vw,2rem) 1.3rem;
  box-shadow:var(--shadow-lg);
  display:flex;
  flex-direction:column;
  gap:1.1rem;
}
.controls.closed{display:none;}
.control-group{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
  gap:1rem 1.4rem;
}
.control label{
  display:block;
  margin-bottom:.45rem;
  font-size:.8rem;
  font-weight:700;
  letter-spacing:.1em;
  text-transform:uppercase;
  color:var(--text-muted);
}
.control select{
  width:100%;
  padding:.6rem .8rem;
  border-radius:var(--radius-sm);
  border:1px solid var(--outline);
  background:var(--surface-soft);
  font-size:.92rem;
  color:var(--text);
  transition:var(--transition);
}
.control select:focus{border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-soft);}
.pivot-controls{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:1rem 1.4rem;
}
.reset-btn{
  align-self:flex-start;
  padding:.6rem 1.05rem;
  border-radius:var(--radius-sm);
  background:var(--surface-soft);
  border:1px solid var(--outline);
  font-weight:600;
}
.reset-btn:hover{border-color:var(--accent);color:var(--accent);}

.stats{
  display:flex;
  gap:.9rem;
  flex-wrap:wrap;
  font-size:.95rem;
  justify-content:flex-start;
}
.stats>div{
  background:var(--surface);
  border-radius:var(--radius-sm);
  padding:.75rem 1rem;
  border:1px solid var(--outline);
  color:var(--text);
  box-shadow:var(--shadow-sm);
}

.pivot-scroll{
  overflow-x:auto;
  max-width:100%;
}
.pivot-table{
  min-width:100%;
}
.pivot{
  border-collapse:separate;
  border-spacing:0;
  width:100%;
  background:var(--surface);
  border:1px solid var(--outline);
  border-radius:var(--radius-lg);
  overflow:hidden;
  box-shadow:var(--shadow-md);
  font-size:.88rem;
}
.pivot thead th{
  position:sticky;
  top:0;
  background:var(--surface-soft);
  color:var(--text);
  font-weight:700;
  padding:.75rem .9rem;
  border-bottom:1px solid var(--divider);
  z-index:3;
}
.pivot tbody th{
  position:sticky;
  left:0;
  background:var(--surface-muted);
  color:var(--text);
  font-weight:600;
  padding:.65rem .8rem;
  border-right:1px solid var(--divider);
  z-index:2;
}
.pivot td,.pivot th{border-bottom:1px solid var(--divider);border-right:1px solid var(--divider);}
.pivot tbody tr:last-child td,.pivot tbody tr:last-child th{border-bottom:none;}
.pivot td{
  padding:.55rem .75rem;
  text-align:center;
  min-width:92px;
  cursor:pointer;
  transition:var(--transition);
  color:var(--text);
}
.pivot td:hover{background:var(--accent-soft);color:var(--accent-strong);}
.pivot td:active{transform:scale(.97);}
.pivot td.selected{
  background:var(--accent);
  color:#fff;
  box-shadow:inset 0 0 0 2px rgba(255,255,255,.35);
  font-weight:600;
}
.mini-list{
  max-height:140px;
  overflow:auto;
  text-align:left;
  line-height:1.35;
  padding-right:.4rem;
}
.mini-list::-webkit-scrollbar{width:6px;}
.mini-list::-webkit-scrollbar-thumb{background:rgba(98,118,179,.45);border-radius:4px;}

.detail-table{
  background:var(--surface);
  border-radius:var(--radius-lg);
  border:1px solid var(--outline);
  padding:1.4rem 1.6rem;
  box-shadow:var(--shadow-lg);
  max-height:360px;
  overflow:auto;
  font-size:.92rem;
  display:flex;
  flex-direction:column;
  gap:1rem;
}
.detail-table h3{
  margin:0;
  font-size:1.05rem;
  color:var(--text);
}
.detail-table ul{
  margin:0;
  padding:0;
  list-style:none;
  display:flex;
  flex-direction:column;
  gap:1rem;
}
.detail-table li{list-style:none;}
.detail-table li b{color:var(--text);}

.detail-item{
  padding:.95rem 1.1rem;
  border-radius:var(--radius-sm);
  background:var(--surface-soft);
  border:1px solid var(--outline);
  box-shadow:0 10px 24px -18px rgba(31,45,90,.35);
  display:flex;
  flex-direction:column;
  gap:.55rem;
  color:var(--text-soft);
}
.detail-comp{font-size:1rem;color:var(--text);}
.detail-con{font-size:.92rem;line-height:1.45;}
.detail-ins{font-size:.9rem;display:flex;align-items:center;gap:.4rem;color:var(--text-soft);}
.detail-ins em{font-style:italic;font-weight:600;color:var(--text);}
.detail-label{font-weight:600;color:var(--text);margin-right:.45rem;}
.detail-empty{font-size:.9rem;color:var(--text-soft);}

.mobile-bar{
  position:fixed;
  bottom:clamp(10px,3vw,20px);
  left:50%;
  transform:translateX(-50%);
  background:rgba(24,34,58,.92);
  backdrop-filter:blur(12px);
  border-radius:999px;
  padding:.45rem .6rem;
  display:flex;
  gap:.35rem;
  z-index:90;
  box-shadow:0 18px 40px -24px rgba(8,12,32,.8);
}
.mobile-bar button{
  width:42px;
  height:42px;
  border-radius:50%;
  font-size:1.1rem;
  color:#fff;
  display:grid;
  place-items:center;
  background:rgba(255,255,255,.1);
}
.mobile-bar button:hover{background:rgba(255,255,255,.18);}


@media (max-width:900px){
  .header{padding:28px 20px 74px;}
  .hero{padding:24px;}
  .top-controls{flex-direction:column;align-items:stretch;}
  .top-actions{width:100%;justify-content:flex-start;}
  .top-actions .action-btn,.top-actions .theme-toggle{flex:1 1 auto;text-align:center;}
  .top-actions .theme-toggle{max-width:54px;flex:0 0 54px;}
  .quick-info{grid-template-columns:1fr;}
  .controls{padding:1.35rem 1.1rem;}
  .mobile-bar{width:calc(100% - 32px);left:16px;transform:none;justify-content:space-evenly;}
}

@media (max-width:600px){
  .action-btn{font-size:.9rem;}
  .filter-toggle{width:100%;text-align:center;}
  .stats{flex-direction:column;}
  .stats>div{width:100%;text-align:center;}
  .detail-table{padding:1.1rem 1.2rem;}
  .mobile-bar{bottom:14px;}
}

@media (max-width:420px){
  .hero{padding:20px;}
  .hero::after{display:none;}
  .hero-shape{display:none;}
  .app-title{font-size:1.55rem;}
  .top-actions{gap:.6rem;}
  .mobile-bar button{width:40px;height:40px;font-size:1rem;}
}

@media (prefers-reduced-motion:reduce){
  *,*::before,*::after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important;}
}
